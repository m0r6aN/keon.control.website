(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,77265,e=>{"use strict";var t=e.i(43476),n=e.i(71645);let s={active:!1,incidentId:null,severity:null,startedAt:null,trustScore:100,trustScoreThreshold:70,rootSubsystem:null,impactedComponents:[],activePolicies:[],quorumState:"met",events:[],lastIrreversibleAction:null,humanInLoop:{acknowledged:[],missing:["operator-1","operator-2"],slaDeadline:new Date(Date.now()+9e5).toISOString()},exitConditionsMet:!1},r=n.createContext(null);function o({children:e}){let[o,a]=n.useState(s),i=n.useCallback(e=>{a(t=>({...t,active:!0,incidentId:e.incidentId,severity:e.severity,startedAt:new Date().toISOString(),rootSubsystem:e.rootSubsystem,impactedComponents:e.impactedComponents??[],exitConditionsMet:!1}))},[]),c=n.useCallback(()=>{a(e=>e.exitConditionsMet?{...s}:e)},[]),u=n.useCallback(e=>{let t={...e,id:`evt_${Date.now()}_${Math.random().toString(36).slice(2,8)}`,timestamp:new Date().toISOString(),schemaVersion:"v1"};a(e=>({...e,events:[...e.events,t]}))},[]),d=n.useCallback(e=>{a(t=>({...t,trustScore:e}))},[]),l=n.useCallback(e=>{a(t=>({...t,humanInLoop:{...t.humanInLoop,acknowledged:t.humanInLoop.acknowledged.includes(e)?t.humanInLoop.acknowledged:[...t.humanInLoop.acknowledged,e],missing:t.humanInLoop.missing.filter(t=>t!==e)}})),u({subsystem:"human-operator",action:"operator.acknowledged.incident",severity:"info",actor:e})},[u]),h=n.useCallback(()=>{let e=!o.events.some(e=>"critical"===e.severity),t=o.trustScore>=o.trustScoreThreshold,n=e&&t;return n!==o.exitConditionsMet&&a(e=>({...e,exitConditionsMet:n})),n},[o.events,o.trustScore,o.trustScoreThreshold,o.exitConditionsMet]);return(0,t.jsx)(r.Provider,{value:{state:o,activateIncident:i,deactivateIncident:c,addEvent:u,updateTrustScore:d,acknowledgeHuman:l,checkExitConditions:h},children:e})}function a(){let e=n.useContext(r);if(!e)throw Error("useIncidentMode must be used within IncidentModeProvider");return e}e.s(["IncidentModeProvider",()=>o,"useIncidentMode",()=>a])},1661,e=>{"use strict";var t=e.i(43476),n=e.i(77265),s=e.i(71645);let r=s.createContext(null),o={tenantId:null,systemMetrics:null,liveMode:!1,isLoading:!1,error:null};function a({children:e,initialState:n}){let[a,i]=s.useState({...o,...n}),c=s.useMemo(()=>({setTenantId:e=>i(t=>({...t,tenantId:e})),setSystemMetrics:e=>i(t=>({...t,systemMetrics:e})),setLiveMode:e=>i(t=>({...t,liveMode:e})),setLoading:e=>i(t=>({...t,isLoading:e})),setError:e=>i(t=>({...t,error:e})),clearError:()=>i(e=>({...e,error:null}))}),[]),u=s.useMemo(()=>({...a,...c}),[a,c]);return(0,t.jsx)(r.Provider,{value:u,children:e})}var i=e.i(47167);function c(){let e=i.default.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:5000",t=parseInt(i.default.env.NEXT_PUBLIC_API_TIMEOUT||"10000",10);return{baseUrl:e,timeout:t,useMockFallback:"false"!==i.default.env.NEXT_PUBLIC_API_USE_MOCK_FALLBACK,liveMode:"true"===i.default.env.NEXT_PUBLIC_API_LIVE_MODE}}let u=c();class d extends Error{statusCode;code;details;constructor(e,t,n,s){super(e),this.statusCode=t,this.code=n,this.details=s,this.name="ApiError"}}class l extends d{constructor(e,t){super(e,void 0,"NETWORK_ERROR",t),this.name="NetworkError"}}class h extends d{constructor(e){super(e,void 0,"TIMEOUT_ERROR"),this.name="TimeoutError"}}class m extends d{constructor(e,t){super(e,400,"VALIDATION_ERROR",t),this.name="ValidationError"}}class p extends d{constructor(e){super(e,404,"NOT_FOUND"),this.name="NotFoundError"}}class w extends d{constructor(e){super(e,401,"UNAUTHORIZED"),this.name="UnauthorizedError"}}class v extends d{constructor(e,t,n){super(e,t,"SERVER_ERROR",n),this.name="ServerError"}}async function I(e){let t=e.headers.get("content-type");return t?.includes("application/json")?e.json():t?.includes("text/")?e.text():e.blob()}async function E(e){let t,n=`Request failed with status ${e.status}`;try{let s=e.headers.get("content-type");if(s?.includes("application/json")){let s=await e.json();n=s.error||s.message||n,t=s}else n=await e.text()||n}catch{}switch(e.status){case 400:throw new m(n,t);case 401:throw new w(n);case 404:throw new p(n);case 500:case 502:case 503:case 504:throw new v(n,e.status,t);default:throw new d(n,e.status,void 0,t)}}function g({children:e}){let s=c();return(0,t.jsx)(a,{initialState:{liveMode:s.liveMode},children:(0,t.jsx)(n.IncidentModeProvider,{children:e})})}new class{config;constructor(e=u){this.config=e}async request(e,t={}){var n;let s,{method:r="GET",body:o,headers:a={},params:i,timeout:c=this.config.timeout,correlationId:u=`${Date.now()}-${Math.random().toString(36).substring(2,9)}`,tenantId:m}=t,p=(n=this.config.baseUrl,s=new URL(e,n),i&&Object.entries(i).forEach(([e,t])=>{null!=t&&s.searchParams.append(e,String(t))}),s.toString()),w={"Content-Type":"application/json","X-Correlation-Id":u,...a};m&&(w["X-Tenant-Id"]=m);let v={method:r,headers:w,body:o?JSON.stringify(o):void 0};try{let e=await new Promise((e,t)=>{let n=setTimeout(()=>{t(new h(`Request timeout after ${c}ms`))},c);fetch(p,v).then(t=>{clearTimeout(n),e(t)}).catch(e=>{clearTimeout(n),t(e)})});return e.ok||await E(e),{data:await I(e),statusCode:e.status,headers:e.headers}}catch(e){throw e instanceof d?e:e instanceof TypeError&&e.message.includes("fetch")?new l("Network request failed. Check your connection and ensure the API is running."):new d(e instanceof Error?e.message:"An unknown error occurred")}}async get(e,t={}){return(await this.request(e,{...t,method:"GET"})).data}async post(e,t,n={}){return(await this.request(e,{...n,method:"POST",body:t})).data}async put(e,t,n={}){return(await this.request(e,{...n,method:"PUT",body:t})).data}async delete(e,t={}){return(await this.request(e,{...t,method:"DELETE"})).data}async patch(e,t,n={}){return(await this.request(e,{...n,method:"PATCH",body:t})).data}},e.s(["Providers",()=>g],1661)}]);